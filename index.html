<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CAD POINT Lead Caller</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <!-- SheetJS Library for Excel reading -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <style>
        /* --- CSS Styles (No Changes Here) --- */
        body {
            font-family: 'Poppins', sans-serif; line-height: 1.6; margin: 0; padding: 15px;
            background-color: #f4f4f4; color: #333; -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        .container {
            max-width: 700px; margin: 15px auto; background: #fff; padding: 25px;
            border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333; text-align: center; margin-top: 0; margin-bottom: 20px;
            font-size: 1.8em; font-weight: 600;
        }
        h1 .cad-red { color: red; font-weight: bold; }
        h1 .point-black { color: black; font-weight: bold; }
        h1 .caller-blue { color: #0056b3; }
        h2 {
            color: #0056b3; text-align: center; margin-bottom: 5px;
            font-size: 1.4em; font-weight: 600;
        }
        .input-section, .output-section, .how-to-use-section, .footer-section {
            margin-bottom: 25px; padding: 15px; border: 1px solid #ddd;
            border-radius: 5px; background-color: #fff;
        }
        textarea {
            width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px;
            font-size: 1em; margin-bottom: 10px; display: block; box-sizing: border-box;
            font-family: inherit; resize: vertical;
        }
        button, .file-label {
            display: inline-block; background-color: #007bff; color: white; padding: 10px 15px;
            border: none; border-radius: 4px; cursor: pointer; font-size: 0.95em;
            text-align: center; transition: background-color 0.3s ease, transform 0.1s ease;
            margin-top: 5px; margin-right: 5px; vertical-align: middle;
            font-family: inherit; font-weight: 600; -webkit-tap-highlight-color: transparent;
        }
        button:hover, .file-label:hover { background-color: #0056b3; }
        button:active, .file-label:active { transform: scale(0.98); }
        #clearFileBtn { background-color: #dc3545; }
        #clearFileBtn:hover { background-color: #c82333; }
        input[type="file"] { display: none; }
        .file-input-area { display: flex; align-items: center; flex-wrap: wrap; gap: 10px; }
        #fileName {
            font-style: italic; color: #555; flex-grow: 1; white-space: nowrap;
            overflow: hidden; text-overflow: ellipsis; min-width: 100px;
            font-family: inherit; font-size: 0.9em;
        }
        #outputNumbers ul { list-style: none; padding: 0; margin: 0; }
        #outputNumbers li {
            margin-bottom: 10px; padding: 10px; background-color: #e9ecef; border-radius: 4px;
            display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 10px;
        }
        #outputNumbers a.call-link {
            text-decoration: none; color: #007bff; font-weight: 600; font-size: 1em;
            padding: 6px 12px; border: 1px solid #007bff; border-radius: 4px; background-color: white;
            transition: background-color 0.3s ease, color 0.3s ease, transform 0.1s ease;
            white-space: nowrap; flex-shrink: 0; font-family: inherit; -webkit-tap-highlight-color: transparent;
        }
        #outputNumbers a.call-link:hover { background-color: #007bff; color: white; }
        #outputNumbers a.call-link:active { transform: scale(0.98); }
        #outputNumbers li span.number-text { word-break: break-all; flex-grow: 1; font-family: inherit; }
        .error-message {
            color: red; font-weight: 600; margin-top: 10px; margin-bottom: 10px;
            min-height: 1.2em; text-align: center; font-family: inherit; font-size: 0.9em;
        }
        .how-to-use-section { background-color: #f0f8ff; border-left: 5px solid #007bff; }
        .how-to-use-section h2 { margin-top: 0; color: #0056b3; font-weight: 600; }
        .how-to-use-section h3 {
            color: #333; margin-top: 15px; margin-bottom: 8px; border-bottom: 1px solid #eee;
            padding-bottom: 5px; font-weight: 600; font-size: 1.1em;
        }
        .how-to-use-section p, .how-to-use-section ol { margin-bottom: 10px; color: #555; font-family: inherit; font-size: 0.95em; }
        .how-to-use-section ol { padding-left: 20px; }
        .how-to-use-section li { margin-bottom: 8px; }
        .how-to-use-section .conclusion { margin-top: 15px; font-weight: bold; color: #0056b3; font-family: inherit; }
        .footer-section {
            margin-top: 30px; padding: 15px; border-top: 1px solid #ccc; text-align: center;
            font-size: 0.9em; color: #444; background-color: #f9f9f9; font-family: inherit;
        }
        .footer-section p { margin-bottom: 10px; line-height: 1.5; }
        .footer-section a { color: #0056b3; text-decoration: none; font-weight: 600; }
        .footer-section a:hover { text-decoration: underline; }
        .footer-section .whatsapp-icon::before { content: 'üí¨'; margin-right: 4px; }
        .footer-section .phone-icon::before { content: 'üìû'; margin-right: 4px; }
        .section-subtitle {
            text-align: center; font-family: 'Poppins', sans-serif; font-size: 1.1em;
            font-weight: 600; margin-top: 0px; margin-bottom: 15px; padding: 5px 0;
        }
        .section-subtitle .gradient-text {
            background: linear-gradient(90deg, #007bff, #0056b3);
            -webkit-background-clip: text; background-clip: text; color: transparent;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
        }
        @media (max-width: 600px) {
            body { padding: 10px; }
            .container { padding: 15px; margin: 10px auto; }
            h1 { font-size: 1.5em; margin-bottom: 15px; }
            h2 { font-size: 1.2em; }
            .section-subtitle { font-size: 1em; margin-bottom: 15px; }
            .input-section, .output-section, .how-to-use-section, .footer-section {
                padding: 12px; margin-bottom: 20px;
            }
             button, .file-label { padding: 8px 12px; font-size: 0.9em; }
            #fileName { font-size: 0.85em; margin-left: 5px; margin-right: 5px; }
             .file-input-area { gap: 8px; }
            #outputNumbers li { padding: 8px; gap: 8px; }
             #outputNumbers a.call-link { font-size: 0.95em; padding: 5px 10px; }
              #outputNumbers li span.number-text { font-size: 0.95em; }
             .how-to-use-section h3 { font-size: 1em; }
             .how-to-use-section p, .how-to-use-section ol { font-size: 0.9em; }
             .footer-section { font-size: 0.85em; padding: 12px; }
        }
    </style>
</head>
<body>

    <div class="container">
        <!-- Header -->
        <h1>
            <span class="cad-red">CAD</span> <span class="point-black">POINT</span> <span class="caller-blue">Lead Caller</span>
        </h1>

        <!-- Error Message Area -->
        <div id="errorMessage" class="error-message"></div>

        <!-- Input Section 1: Paste Numbers -->
        <div class="input-section">
            <h2>1. ‡§®‡§Ç‡§¨‡§∞ ‡§™‡•á‡§∏‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç (‡§π‡§∞ ‡§®‡§Ç‡§¨‡§∞ ‡§®‡§à ‡§≤‡§æ‡§á‡§® ‡§™‡§∞)</h2>
            <p class="section-subtitle">
                <span class="gradient-text">Ab Number Dial karne ka Jhanjhat khatam</span> üòÇ
            </p>
            <textarea id="numberInput" rows="8" placeholder="‡§Ø‡§π‡§æ‡§Ç ‡§´‡§º‡•ã‡§® ‡§®‡§Ç‡§¨‡§∞ ‡§™‡•á‡§∏‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç..."></textarea>
            <button id="processTextBtn">‡§™‡•á‡§∏‡•ç‡§ü ‡§ï‡§ø‡§è ‡§ó‡§è ‡§®‡§Ç‡§¨‡§∞ ‡§™‡•ç‡§∞‡•ã‡§∏‡•á‡§∏ ‡§ï‡§∞‡•á‡§Ç</button>
        </div>

        <!-- Input Section 2: Upload File -->
        <div class="input-section">
            <h2>‡§Ø‡§æ 2. ‡§≤‡•Ä‡§° ‡§´‡§º‡§æ‡§á‡§≤ ‡§Ö‡§™‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç (.txt, .csv, .xls, .xlsx)</h2>
            <div class="file-input-area">
                 <label for="fileInput" class="file-label">‡§´‡§º‡§æ‡§á‡§≤ ‡§ö‡•Å‡§®‡•á‡§Ç</label>
                 <input type="file" id="fileInput" accept=".txt, .csv, .xls, .xlsx, application/vnd.ms-excel, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"> <!-- More specific MIME types added -->
                 <span id="fileName">‡§ï‡•ã‡§à ‡§´‡§º‡§æ‡§á‡§≤ ‡§®‡§π‡•Ä‡§Ç ‡§ö‡•Å‡§®‡•Ä ‡§ó‡§à</span>
                 <button id="clearFileBtn" title="‡§ö‡§Ø‡§® ‡§π‡§ü‡§æ‡§è‡§Ç">X</button>
             </div>
        </div>

        <!-- Output Section: Clickable Numbers -->
        <div class="output-section">
            <h2>‡§ï‡•ç‡§≤‡§ø‡§ï ‡§ï‡§∞‡§®‡•á ‡§Ø‡•ã‡§ó‡•ç‡§Ø ‡§®‡§Ç‡§¨‡§∞</h2>
            <div id="outputNumbers">
                <p>‡§Ø‡§π‡§æ‡§Ç ‡§™‡•ç‡§∞‡•ã‡§∏‡•á‡§∏ ‡§ï‡§ø‡§è ‡§ó‡§è ‡§®‡§Ç‡§¨‡§∞ ‡§¶‡§ø‡§ñ‡§æ‡§à ‡§¶‡•á‡§Ç‡§ó‡•á...</p>
            </div>
        </div>

        <!-- How to Use Section -->
        <div class="how-to-use-section">
             <!-- Content remains the same -->
            <h2>‡§ï‡•à‡§∏‡•á ‡§á‡§∏‡•ç‡§§‡•á‡§Æ‡§æ‡§≤ ‡§ï‡§∞‡•á‡§Ç (How to Use)</h2>
            <h3>‡§§‡§∞‡•Ä‡§ï‡§æ 1: ‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§∏‡•á (‡§Ü‡§∏‡§æ‡§® ‡§§‡§∞‡•Ä‡§ï‡§æ)</h3>
            <ol>
                <li>‡§Ü‡§™‡§ï‡•á ‡§ï‡§Ç‡§™‡•ç‡§Ø‡•Ç‡§ü‡§∞ ‡§Ø‡§æ ‡§≤‡•à‡§™‡§ü‡•â‡§™ ‡§Æ‡•á‡§Ç ‡§ú‡§ø‡§§‡§®‡•á ‡§≠‡•Ä ‡§®‡§Ç‡§¨‡§∞ ‡§π‡•à‡§Ç, ‡§â‡§®‡§ï‡•Ä ‡§≤‡§ø‡§∏‡•ç‡§ü ‡§ï‡•ã ‡§Ö‡§™‡§®‡•á ‡§ï‡§ø‡§∏‡•Ä WhatsApp ‡§®‡§Ç‡§¨‡§∞ ‡§™‡§∞ ‡§≠‡•á‡§ú‡•á‡§Ç (‡§ú‡§ø‡§∏ ‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§∏‡•á ‡§Ü‡§™ ‡§ï‡•â‡§≤ ‡§ï‡§∞‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç)‡•§</li>
                <li>‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§Æ‡•á‡§Ç WhatsApp ‡§ñ‡•ã‡§≤‡•á‡§Ç, ‡§â‡§® ‡§∏‡§≠‡•Ä ‡§®‡§Ç‡§¨‡§∞‡•ã‡§Ç ‡§ï‡•ã ‡§è‡§ï ‡§∏‡§æ‡§• ‡§ö‡•Å‡§®‡•á‡§Ç (Select All) ‡§î‡§∞ ‡§ï‡•â‡§™‡•Ä ‡§ï‡§∞‡•á‡§Ç‡•§</li>
                <li>‡§á‡§∏ ‡§ü‡•Ç‡§≤ (‡§µ‡•á‡§¨‡§™‡•á‡§ú) ‡§ï‡•ã ‡§Ö‡§™‡§®‡•á ‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§¨‡•ç‡§∞‡§æ‡§â‡•õ‡§∞ ‡§Æ‡•á‡§Ç ‡§ñ‡•ã‡§≤‡•á‡§Ç ‡§î‡§∞ ‡§ï‡•â‡§™‡•Ä ‡§ï‡§ø‡§Ø‡•á ‡§π‡•Å‡§è ‡§®‡§Ç‡§¨‡§∞‡•ã‡§Ç ‡§ï‡•ã ‡§ä‡§™‡§∞ ‡§µ‡§æ‡§≤‡•á ‡§ü‡•á‡§ï‡•ç‡§∏‡•ç‡§ü ‡§¨‡•â‡§ï‡•ç‡§∏ ‡§Æ‡•á‡§Ç ‡§™‡•á‡§∏‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç‡•§</li>
                <li>"‡§™‡•á‡§∏‡•ç‡§ü ‡§ï‡§ø‡§è ‡§ó‡§è ‡§®‡§Ç‡§¨‡§∞ ‡§™‡•ç‡§∞‡•ã‡§∏‡•á‡§∏ ‡§ï‡§∞‡•á‡§Ç" ‡§¨‡§ü‡§® ‡§™‡§∞ ‡§ï‡•ç‡§≤‡§ø‡§ï ‡§ï‡§∞‡•á‡§Ç‡•§</li>
                <li>‡§Ö‡§¨ ‡§π‡§∞ ‡§®‡§Ç‡§¨‡§∞ ‡§ï‡•á ‡§∏‡§æ‡§Æ‡§®‡•á "‡§ï‡•â‡§≤ ‡§ï‡§∞‡•á‡§Ç" ‡§ï‡§æ ‡§¨‡§ü‡§® ‡§Ü ‡§ú‡§æ‡§è‡§ó‡§æ‡•§ ‡§ú‡§ø‡§∏ ‡§®‡§Ç‡§¨‡§∞ ‡§™‡§∞ ‡§ï‡•â‡§≤ ‡§ï‡§∞‡§®‡§æ ‡§π‡•à, ‡§â‡§∏‡§ï‡•á ‡§¨‡§ü‡§® ‡§™‡§∞ ‡§ï‡•ç‡§≤‡§ø‡§ï ‡§ï‡§∞‡•á‡§Ç, ‡§®‡§Ç‡§¨‡§∞ ‡§Ü‡§™‡§ï‡•á ‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§°‡§æ‡§Ø‡§≤‡§∞ ‡§Æ‡•á‡§Ç ‡§Ö‡§™‡§®‡•á ‡§Ü‡§™ ‡§Ü ‡§ú‡§æ‡§è‡§ó‡§æ‡•§</li>
            </ol>
            <h3>‡§§‡§∞‡•Ä‡§ï‡§æ 2: ‡§ï‡§Ç‡§™‡•ç‡§Ø‡•Ç‡§ü‡§∞ ‡§∏‡•á (‡§≤‡§ø‡§Ç‡§ï‡•ç‡§° ‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§ï‡•á ‡§∏‡§æ‡§•)</h3>
             <ol>
                <li>‡§∏‡•Å‡§®‡§ø‡§∂‡•ç‡§ö‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç ‡§ï‡§ø ‡§Ü‡§™‡§ï‡•á ‡§ï‡§Ç‡§™‡•ç‡§Ø‡•Ç‡§ü‡§∞ ‡§ï‡•á Chrome ‡§¨‡•ç‡§∞‡§æ‡§â‡•õ‡§∞ ‡§î‡§∞ ‡§Ü‡§™‡§ï‡•á ‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡•û‡•ã‡§® (Android) ‡§Æ‡•á‡§Ç ‡§è‡§ï ‡§π‡•Ä Google (Gmail) ‡§Ö‡§ï‡§æ‡§â‡§Ç‡§ü ‡§≤‡•â‡§ó ‡§á‡§® ‡§π‡•à‡•§</li>
                <li>Chrome ‡§ï‡•Ä "Call from device" ‡§Ø‡§æ "‡§´‡§º‡•ã‡§® ‡§∏‡•á ‡§ï‡•â‡§≤ ‡§ï‡§∞‡•á‡§Ç" ‡§∏‡•Å‡§µ‡§ø‡§ß‡§æ ‡§∏‡•á‡§ü‡§Ö‡§™ ‡§π‡•ã‡§®‡•Ä ‡§ö‡§æ‡§π‡§ø‡§è‡•§</li>
                <li>‡§á‡§∏ ‡§ü‡•Ç‡§≤ ‡§ï‡•ã ‡§ï‡§Ç‡§™‡•ç‡§Ø‡•Ç‡§ü‡§∞ ‡§ï‡•á Chrome ‡§¨‡•ç‡§∞‡§æ‡§â‡•õ‡§∞ ‡§Æ‡•á‡§Ç ‡§ñ‡•ã‡§≤‡•á‡§Ç‡•§</li>
                <li>‡§ä‡§™‡§∞ ‡§µ‡§æ‡§≤‡•á ‡§ü‡•á‡§ï‡•ç‡§∏‡•ç‡§ü ‡§¨‡•â‡§ï‡•ç‡§∏ ‡§Æ‡•á‡§Ç ‡§∏‡§≠‡•Ä ‡§®‡§Ç‡§¨‡§∞ ‡§ï‡•â‡§™‡•Ä-‡§™‡•á‡§∏‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç ‡§Ø‡§æ ‡§´‡§º‡§æ‡§á‡§≤ ‡§Ö‡§™‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞ ‡§™‡•ç‡§∞‡•ã‡§∏‡•á‡§∏ ‡§ï‡§∞‡•á‡§Ç‡•§</li>
                <li>‡§ú‡§ø‡§∏ ‡§®‡§Ç‡§¨‡§∞ ‡§™‡§∞ ‡§ï‡•â‡§≤ ‡§ï‡§∞‡§®‡§æ ‡§π‡•à, ‡§â‡§∏‡§ï‡•á ‡§∏‡§æ‡§Æ‡§®‡•á "‡§ï‡•â‡§≤ ‡§ï‡§∞‡•á‡§Ç" ‡§≤‡§ø‡§Ç‡§ï ‡§™‡§∞ ‡§ï‡•ç‡§≤‡§ø‡§ï ‡§ï‡§∞‡•á‡§Ç‡•§</li>
                <li>Chrome ‡§Æ‡•á‡§Ç ‡§è‡§ï ‡§õ‡•ã‡§ü‡§æ ‡§™‡•â‡§™-‡§Ö‡§™ ‡§Ü‡§è‡§ó‡§æ ‡§ú‡•ã ‡§™‡•Ç‡§õ‡•á‡§ó‡§æ ‡§ï‡§ø ‡§Ü‡§™ ‡§ï‡§ø‡§∏ ‡§≤‡§ø‡§Ç‡§ï‡•ç‡§° ‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§°‡§ø‡§µ‡§æ‡§á‡§∏ ‡§∏‡•á ‡§ï‡•â‡§≤ ‡§ï‡§∞‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç‡•§ ‡§Ö‡§™‡§®‡§æ ‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§°‡§ø‡§µ‡§æ‡§á‡§∏ ‡§ö‡•Å‡§®‡•á‡§Ç‡•§</li>
                <li>‡§®‡§Ç‡§¨‡§∞ ‡§Ü‡§™‡§ï‡•á ‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§ï‡•á ‡§°‡§æ‡§Ø‡§≤‡§∞ ‡§∏‡•ç‡§ï‡•ç‡§∞‡•Ä‡§® ‡§™‡§∞ ‡§Ö‡§™‡§®‡•á ‡§Ü‡§™ ‡§¶‡§ø‡§ñ‡§®‡•á ‡§≤‡§ó‡•á‡§ó‡§æ, ‡§¨‡§∏ ‡§ï‡•â‡§≤ ‡§¨‡§ü‡§® ‡§¶‡§¨‡§æ‡§®‡§æ ‡§π‡•ã‡§ó‡§æ‡•§</li>
             </ol>
             <p class="conclusion">
                 ‡§®‡§ø‡§∑‡•ç‡§ï‡§∞‡•ç‡§∑: ‡§§‡§∞‡•Ä‡§ï‡§æ 1 (‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§∏‡•á ‡§á‡§∏‡•ç‡§§‡•á‡§Æ‡§æ‡§≤) ‡•õ‡•ç‡§Ø‡§æ‡§¶‡§æ ‡§Ü‡§∏‡§æ‡§® ‡§î‡§∞ ‡§∏‡•Ä‡§ß‡§æ ‡§π‡•à‡•§
             </p>
        </div>

        <!-- Footer Section: Contact Info -->
        <div class="footer-section">
            <!-- Content remains the same -->
           <p>
                If You face any issue or want to know more about how to use, Feel free to contact:
            </p>
            <p>
                <span class="whatsapp-icon"></span>WhatsApp:
                <a href="https://wa.me/919135684363?text=Hi%20Satyam,%20I%20need%20help%20with%20the%20CAD%20POINT%20Lead%20Caller." target="_blank">9135684363</a>
            </p>
             <p>
                <span class="phone-icon"></span>Call: <a href="tel:+919135684363">9135684363</a>
                (Satyam)
            </p>
        </div>

    </div> <!-- End of container -->

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const numberInput = document.getElementById('numberInput');
            const processTextBtn = document.getElementById('processTextBtn');
            const fileInput = document.getElementById('fileInput');
            const fileNameDisplay = document.getElementById('fileName');
            const clearFileBtn = document.getElementById('clearFileBtn');
            const outputNumbersDiv = document.getElementById('outputNumbers');
            const errorMessageDiv = document.getElementById('errorMessage');

            function displayError(message) { errorMessageDiv.textContent = message; }
            function clearError() { errorMessageDiv.textContent = ''; }
            function resetFileInput() {
                fileInput.value = null;
                fileNameDisplay.textContent = '‡§ï‡•ã‡§à ‡§´‡§º‡§æ‡§á‡§≤ ‡§®‡§π‡•Ä‡§Ç ‡§ö‡•Å‡§®‡•Ä ‡§ó‡§à';
            }

            // --- Event Listeners ---
            processTextBtn.addEventListener('click', () => {
                clearError();
                try {
                    const text = numberInput.value;
                    if (text.trim() === '') {
                        displayError('‡§ï‡•É‡§™‡§Ø‡§æ ‡§ü‡•á‡§ï‡•ç‡§∏‡•ç‡§ü ‡§è‡§∞‡§ø‡§Ø‡§æ ‡§Æ‡•á‡§Ç ‡§®‡§Ç‡§¨‡§∞ ‡§™‡•á‡§∏‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç‡•§');
                        outputNumbersDiv.innerHTML = ''; return;
                    }
                    const numbers = parseNumbersFromText(text);
                    displayClickableNumbers(numbers);
                    resetFileInput();
                } catch (error) {
                    displayError('‡§ü‡•á‡§ï‡•ç‡§∏‡•ç‡§ü ‡§™‡•ç‡§∞‡•ã‡§∏‡•á‡§∏ ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø: ' + error.message);
                    outputNumbersDiv.innerHTML = '<p>‡§®‡§Ç‡§¨‡§∞ ‡§™‡•ç‡§∞‡•ã‡§∏‡•á‡§∏ ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§∏‡§Æ‡§∏‡•ç‡§Ø‡§æ ‡§π‡•Å‡§à‡•§</p>';
                    console.error("Error during text processing:", error);
                }
            });

            fileInput.addEventListener('change', (event) => {
                clearError();
                const file = event.target.files[0];
                if (!file) {
                    resetFileInput(); return;
                }

                fileNameDisplay.textContent = file.name;
                const reader = new FileReader();
                const fileType = file.name.split('.').pop().toLowerCase();

                reader.onload = (e) => {
                    console.log("FileReader onload triggered for file type:", fileType); // Debug Log
                    try {
                        let numbers = [];
                        if (fileType === 'txt' || fileType === 'csv') {
                            // --- Handle TXT/CSV ---
                            console.log("Reading as text file..."); // Debug Log
                            const fileContent = e.target.result;
                            if (!fileContent || fileContent.trim() === '') {
                                displayError('‡§´‡§º‡§æ‡§á‡§≤ ‡§ñ‡§æ‡§≤‡•Ä ‡§π‡•à ‡§Ø‡§æ ‡§ü‡•á‡§ï‡•ç‡§∏‡•ç‡§ü ‡§´‡•â‡§∞‡•ç‡§Æ‡•á‡§ü ‡§Æ‡•á‡§Ç ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡•§');
                                outputNumbersDiv.innerHTML = ''; return;
                            }
                            numbers = parseNumbersFromText(fileContent);

                        } else if (fileType === 'xls' || fileType === 'xlsx') {
                             // --- Handle Excel using SheetJS ---
                             console.log("Reading as Excel file..."); // Debug Log
                            const data = new Uint8Array(e.target.result);
                            console.log("ArrayBuffer length:", data.length); // Debug Log

                            // Check if SheetJS is loaded
                            if (typeof XLSX === 'undefined') {
                                throw new Error("‡§è‡§ï‡•ç‡§∏‡•á‡§≤ ‡§∞‡•Ä‡§°‡§ø‡§Ç‡§ó ‡§≤‡§æ‡§á‡§¨‡•ç‡§∞‡•á‡§∞‡•Ä (SheetJS) ‡§≤‡•ã‡§° ‡§®‡§π‡•Ä‡§Ç ‡§π‡•Å‡§à‡•§");
                            }

                            const workbook = XLSX.read(data, { type: 'array' });
                            console.log("Workbook Sheets:", workbook.SheetNames); // Debug Log

                            if (!workbook.SheetNames || workbook.SheetNames.length === 0) {
                                throw new Error("‡§è‡§ï‡•ç‡§∏‡•á‡§≤ ‡§´‡§º‡§æ‡§á‡§≤ ‡§Æ‡•á‡§Ç ‡§ï‡•ã‡§à ‡§∂‡•Ä‡§ü ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡•Ä‡•§");
                            }
                            const firstSheetName = workbook.SheetNames[0]; // Use the first sheet found
                            const worksheet = workbook.Sheets[firstSheetName];

                             if (!worksheet) {
                                throw new Error(`‡§è‡§ï‡•ç‡§∏‡•á‡§≤ ‡§´‡§º‡§æ‡§á‡§≤ ‡§Æ‡•á‡§Ç ‡§∂‡•Ä‡§ü '${firstSheetName}' ‡§®‡§π‡•Ä‡§Ç ‡§™‡§¢‡§º‡•Ä ‡§ú‡§æ ‡§∏‡§ï‡•Ä‡•§`);
                            }

                            // Extract data as array of arrays
                            const sheetData = XLSX.utils.sheet_to_json(worksheet, { header: 1, raw: false, defval: null }); // Use null defval
                            console.log("Excel Sheet Data (raw arrays):", sheetData.slice(0, 10)); // Log first 10 rows

                            // --- *** UPDATED EXTRACTION LOGIC: Look in all cells *** ---
                            let extractedNumbersText = "";
                            sheetData.forEach((row, rowIndex) => {
                                if (row && Array.isArray(row)) {
                                    row.forEach((cellValue, colIndex) => {
                                        // Check if cellValue is not null/undefined
                                        if (cellValue !== null && cellValue !== undefined) {
                                            const cellString = String(cellValue).trim();
                                            // Add any non-empty cell content.
                                            // parseNumbersFromText will validate if it's a phone number.
                                            if(cellString) {
                                                extractedNumbersText += cellString + '\n';
                                            }
                                        }
                                    });
                                }
                            });
                            // --- *** END OF UPDATED EXTRACTION LOGIC *** ---

                            console.log("Text Extracted from All Excel Cells:", extractedNumbersText.substring(0, 500) + "..."); // Debug Log

                            if (extractedNumbersText.trim() === '') {
                                 throw new Error("‡§è‡§ï‡•ç‡§∏‡•á‡§≤ ‡§´‡§º‡§æ‡§á‡§≤ ‡§ï‡•Ä ‡§™‡§π‡§≤‡•Ä ‡§∂‡•Ä‡§ü ‡§Æ‡•á‡§Ç ‡§ï‡•ã‡§à ‡§™‡§π‡§ö‡§æ‡§®‡§®‡•á ‡§Ø‡•ã‡§ó‡•ç‡§Ø ‡§ü‡•á‡§ï‡•ç‡§∏‡•ç‡§ü/‡§®‡§Ç‡§¨‡§∞ ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ‡•§");
                            }
                            // Parse the extracted text using the existing function
                            numbers = parseNumbersFromText(extractedNumbersText);
                            console.log("Numbers Parsed from Excel Text:", numbers); // Debug Log

                        } else {
                             throw new Error("‡§Ö‡§∏‡§Æ‡§∞‡•ç‡§•‡§ø‡§§ ‡§´‡§º‡§æ‡§á‡§≤ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞: ." + fileType);
                        }

                        // Display results
                        displayClickableNumbers(numbers);
                        numberInput.value = ''; // Clear textarea after successful file processing

                    } catch (error) {
                         displayError('‡§´‡§º‡§æ‡§á‡§≤ ‡§™‡•ç‡§∞‡•ã‡§∏‡•á‡§∏ ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø: ' + error.message);
                         outputNumbersDiv.innerHTML = '<p>‡§´‡§º‡§æ‡§á‡§≤ ‡§ï‡•á ‡§®‡§Ç‡§¨‡§∞ ‡§™‡•ç‡§∞‡•ã‡§∏‡•á‡§∏ ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§∏‡§Æ‡§∏‡•ç‡§Ø‡§æ ‡§π‡•Å‡§à‡•§ ‡§ï‡•É‡§™‡§Ø‡§æ ‡§ï‡§Ç‡§∏‡•ã‡§≤ (F12) ‡§¶‡•á‡§ñ‡•á‡§Ç‡•§</p>';
                         console.error("Error during file processing:", error);
                    }
                }; // end reader.onload

                reader.onerror = (errorEvent) => {
                    displayError('‡§´‡§º‡§æ‡§á‡§≤ ‡§™‡§¢‡§º‡§®‡•á ‡§Æ‡•á‡§Ç ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§π‡•Å‡§à‡•§');
                    outputNumbersDiv.innerHTML = '<p>‡§´‡§º‡§æ‡§á‡§≤ ‡§™‡§¢‡§º‡§®‡•á ‡§Æ‡•á‡§Ç ‡§∏‡§Æ‡§∏‡•ç‡§Ø‡§æ ‡§π‡•Å‡§à‡•§</p>';
                    resetFileInput();
                    console.error("File Reading Error:", errorEvent);
                };

                // Read file based on type
                if (fileType === 'txt' || fileType === 'csv') {
                    reader.readAsText(file);
                } else if (fileType === 'xls' || fileType === 'xlsx') {
                    reader.readAsArrayBuffer(file);
                } else {
                    displayError("‡§Ö‡§∏‡§Æ‡§∞‡•ç‡§•‡§ø‡§§ ‡§´‡§º‡§æ‡§á‡§≤ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞: ." + fileType);
                    resetFileInput();
                }
            }); // end fileInput listener

            clearFileBtn.addEventListener('click', () => {
                clearError();
                resetFileInput();
                outputNumbersDiv.innerHTML = '<p>‡§´‡§º‡§æ‡§á‡§≤ ‡§ö‡§Ø‡§® ‡§π‡§ü‡§æ ‡§¶‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à‡•§</p>';
            });

            // --- Helper Functions (parseNumbersFromText, displayClickableNumbers) ---
            function parseNumbersFromText(text) {
                 console.log("Parsing text starting with:", text ? text.substring(0, 100) + "..." : "null"); // Debug Log
                if (!text) return [];
                // More robust splitting: handles various line breaks and separators
                const lines = text.split(/[\r\n,;]+/).map(line => line.trim()).filter(line => line); // Split by newline, comma, semicolon, trim, remove empty
                console.log("Lines found:", lines.length, lines.slice(0, 10)); // Debug Log

                const numbersMap = new Map();
                lines.forEach(line => {
                    const originalFormat = line; // Already trimmed
                    // Remove common non-digit characters except leading +
                    let potentialNumber = originalFormat.replace(/[()\-\s./#*]/g, ''); // Added ./#* removal

                    // Handle leading '0' for Indian numbers (optional, depends on data)
                    // if (potentialNumber.startsWith('0') && potentialNumber.length === 11) {
                    //     potentialNumber = '+91' + potentialNumber.substring(1);
                    // } else if (potentialNumber.length === 10 && !potentialNumber.startsWith('+')) {
                    //      potentialNumber = '+91' + potentialNumber; // Assuming Indian numbers if 10 digits
                    // }

                    if (potentialNumber.startsWith('00')) {
                        potentialNumber = '+' + potentialNumber.substring(2);
                    }

                    // Validate format (7-15 digits, optional +)
                    if (potentialNumber.match(/^\+?\d{7,15}$/)) {
                        if (!numbersMap.has(potentialNumber)) {
                             numbersMap.set(potentialNumber, originalFormat);
                             console.log(`Valid number added: Original='${originalFormat}', Cleaned='${potentialNumber}'`);// Debug Log
                        }
                    } else {
                         // Optional: Log skipped lines only if they aren't obviously headers etc.
                         if (originalFormat.match(/\d/)) { // Only log if it contained digits but failed validation
                            console.warn(`Skipping invalid format: '${originalFormat}' (Cleaned: '${potentialNumber}')`);
                         }
                    }
                });
                const results = Array.from(numbersMap, ([cleaned, original]) => ({ original, cleaned }));
                 console.log(`Parsing complete. Found ${results.length} unique valid numbers.`); // Debug Log
                return results;
            }

            function displayClickableNumbers(numberData) {
                outputNumbersDiv.innerHTML = '';
                if (!numberData || numberData.length === 0) {
                    outputNumbersDiv.innerHTML = '<p>‡§™‡•ç‡§∞‡•ã‡§∏‡•á‡§∏ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡•ã‡§à ‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§´‡§º‡•ã‡§® ‡§®‡§Ç‡§¨‡§∞ ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ‡•§ ‡§∏‡•Å‡§®‡§ø‡§∂‡•ç‡§ö‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç ‡§ï‡§ø ‡§®‡§Ç‡§¨‡§∞ ‡§∏‡§π‡•Ä ‡§´‡•â‡§∞‡•ç‡§Æ‡•á‡§ü ‡§Æ‡•á‡§Ç ‡§π‡•à‡§Ç (‡§ï‡§Æ ‡§∏‡•á ‡§ï‡§Æ 7 ‡§Ö‡§Ç‡§ï) ‡§î‡§∞ ‡§´‡§º‡§æ‡§á‡§≤ ‡§Æ‡•á‡§Ç ‡§Æ‡•å‡§ú‡•Ç‡§¶ ‡§π‡•à‡§Ç‡•§</p>';
                    return;
                }
                const ul = document.createElement('ul');
                numberData.forEach(data => {
                    try {
                        if (!data || !data.original || !data.cleaned) return;
                        const li = document.createElement('li');
                        const numberText = document.createElement('span');
                        numberText.className = 'number-text';
                        numberText.textContent = data.original;
                        const a = document.createElement('a');
                        a.className = 'call-link';
                        a.href = `tel:${data.cleaned}`;
                        a.textContent = '‡§ï‡•â‡§≤ ‡§ï‡§∞‡•á‡§Ç';
                        li.appendChild(numberText); li.appendChild(a); ul.appendChild(li);
                    } catch (error) {
                         console.error(`Error displaying number ${data?.original}: ${error.message}`, error);
                         const errorLi = document.createElement('li');
                         errorLi.textContent = `‡§®‡§Ç‡§¨‡§∞ ${data?.original || '?'} ‡§¶‡§ø‡§ñ‡§æ‡§®‡•á ‡§Æ‡•á‡§Ç ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø‡•§`;
                         errorLi.style.color = 'orange'; ul.appendChild(errorLi);
                    }
                });
                outputNumbersDiv.appendChild(ul);
            }

            outputNumbersDiv.innerHTML = '<p>‡§®‡§Ç‡§¨‡§∞ ‡§™‡•á‡§∏‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç ‡§Ø‡§æ ‡§´‡§º‡§æ‡§á‡§≤ ‡§Ö‡§™‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç...</p>';
        }); // End of DOMContentLoaded
    </script>

</body>
</html>